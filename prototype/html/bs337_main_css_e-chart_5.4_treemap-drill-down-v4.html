<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!--link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" -->
    <!--link href="ui/bootstrap-5.3.0/css/bootstrap.min.css" rel="stylesheet" -->
    <!--link href="ui/bootstrap-5.3.0/css/bootstrap.css" rel="stylesheet" -->
    <link href="ui/bootstrap-5.3.0/css/main.css" rel="stylesheet" >	

    <link href="ui/jqGrid/css/ui.jqgrid.min.css"                 media="all" rel="stylesheet" type="text/css" />    
    <link href="ui/jqGrid/plugins/css/ui.multiselect.min.css"                 media="all" rel="stylesheet" type="text/css" />    

    <!-- Icons css yclee 2022-10-25 -->
    <link href="ui/material-design-icons/css/materialdesignicons.min.css" media="all" rel="stylesheet" type="text/css" />
    <link href="ui/remixicon-2.5.0/fonts/remixicon.css"               media="all" rel="stylesheet" type="text/css" />
    <link href="ui/unicons/css/unicons.css"                 media="all" rel="stylesheet" type="text/css" />
    <link href="ui/unicons/css/animation.css"                 media="all" rel="stylesheet" type="text/css" />    

    <!-- <link href="ui/jqGrid/css/ui.jqgrid.min.css"                 media="all" rel="stylesheet" type="text/css" />     -->

     <!-- <link href="ui/jquery-ui-1.12.1/jquery-ui.theme.min.css"                 media="all" rel="stylesheet" type="text/css" />         -->
     <link href="ui/jquery-ui-1.12.1/jquery-ui.min.css"                 media="all" rel="stylesheet" type="text/css" />        

     <!-- <link href="ui/jqGrid-4.7.0/css/ui.jqgrid.css"                 media="all" rel="stylesheet" type="text/css" />         
     <link href="ui/jqGrid-4.7.0/css/ui.jqgrid-bootstrap5.css"                 media="all" rel="stylesheet" type="text/css" />         -->

    <link href="ui/dp/css/layout.css"                 media="all" rel="stylesheet" type="text/css" />        
    <link href="ui/dp/css/bootstrap-overwrite.css"                 media="all" rel="stylesheet" type="text/css" />        

    <style>
      /* 테이블 컬럼명의 글자색 blue */
      div#jqgh_tableList1Grid_BASE_DATE {
        color: blue;
      }
      div#jqgh_tableList2Grid_BASE_DATE {
        color: blue;
      }      
      div#jqgh_tableList1Grid_ROW_CNT{
        color: blue;
      }
      div#jqgh_tableList1Grid_STORAGE_MB{
        color: blue;
      }
      </style>
</head>

<body>
<!-- html contents START -->

<div class="container mt-4">
  <!-- 탭 메뉴 -->
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" data-bs-toggle="tab" href="#tab1" role="tab">기간계</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="tab" href="#tab2" role="tab">정보계</a>
    </li>
  </ul>

  <!-- 탭 내용 -->
  <div class="tab-content mt-4">
    <!-- tab1 -->
    <div class="tab-pane fade show active" id="tab1" style="width: 100%; height:350px; background-color: white;" role="tabpanel">

      <!-- 기간계 첫번째 탭 내용 -->
      <div class="d-flex flex-row mb-3">
        <div class="p-2" style="width: 300px; background-color: #DEEBF7;">
          <!-- LEFT AERA - TABLE COUNT ////////////////////-->
          <div class="ps-3 pe-3 pt-3 pb-3 " style="background-color: #DEEBF7; height: 400px; width: 240px; float: left; position: relative;">

            <div align="left" class="mt-1">
              <span style="font-weight: bold; font-size: 14px; color:blue;">></span>
              <span style="font-weight: bold; font-size: 14px">전체테이블수</span>
            </div>

            <div align="center" class="pt-2 pb-3">
              <span class="badge text-bg-light" style="font-weight: bold; padding: 15px 25px 15px 25px; font-size: 16px;">
                8,472
                <span style="color: red; font-size: 10px;">▲3</span>
              </span>
            </div>

            <div align="left" class="mt-1">
              <span style="font-weight: bold; font-size: 14px; color:blue;">></span>                  
              <span style="font-weight: bold; font-size: 14px">최근 신규 테이블(2주)</span>
            </div>
            <div align="left" class="pt-2">
              <ul style="padding-left: 10px">
                <li class="pb-1" style="list-style-type: none; font-weight: bold; font-size: 12px;">방카슈랑스고객정보</li>
                <li class="pb-1" style="list-style-type: none; font-weight: bold; font-size: 12px;">장기보험요율정보</li>
              </ul>
            </div>
          </div>        
          <!-- LEFT AERA - TABLE COUNT ////////////////////-->
        </div>
      <div class="p-2" style="width: 80%; min-width: 100px; background-color: #DEEBF7;">
        <!-- 레거시 차트 영역 -->
        <div class="" id="chartCoreAp" style="height: 100%; overflow: hidden;">
        </div>
        <!-- 레거시 차트 영역 -->        
      </div>
        <!--div class="p-2" style="display: none; width: 240px; background-color: gray;">Flex item 3</div-->
      <div id="tableUsageTop10" class="p-2 d-none" style="width: 350px; background-color: white;">
        <!-- 활용 영역 -->        
        <div class="border-bottom">
          <span style="font-weight: bold; font-size: 14px">테이블 활용현황 Top10 - </span>
          <span style="font-weight: bold; font-size: 14px; color:blue;">></span>
        </div>
        <div id="tableUsageTop10Div">
          <table id="tableUsageTop10Grid"></table>
          <!-- <div id="tableUsageTop10GridPager"></div> -->
        </div>
        <!-- 활용 영역 -->        

      </div>
      </div>
                    
      <!--
      TABLE 정보 시작
      -->       
      <div class="row" id="bottomDivRow1">

        <div align="right" class="mb-2 mt-2">
          <span style="font-weight: bold; font-size: 20px; float: left">계약관리</span>
          <span style="color: red; font-size: 12px;">* 용량(MB)/건수는 데이터 기준일 기반으로 수정되어 표시됩니다.</span>
          <button id="btnSortByCreatedDate1" type="button" class="btn btn-secondary btn-sm">최근 생성일순 정렬</button>
          <button id="btnExpand1" type="button"   class="btn btn-secondary btn-sm">+펼치기</button>
          <button id="btnCollapse1" type="button" class="btn btn-secondary btn-sm d-none">-줄이기</button>
        </div>

        <div id="bottomData1" class="col-12" style="height: 300px; overflow-y:scroll;">

          <div id="tableList1Div">
            <table id="tableList1Grid"></table>
            <div id="tableList1GridPager"></div>
          </div>
   
        </div>
      </div>
      <!--
      TABLE 정보 끝
      -->       
    </div>
      <!-- 기간계 첫번째 탭 내용 -->

    <!-- tab2 -->    
    <div class="tab-pane fade" id="tab2" style="width: 100%; height:350px; background-color: white;" role="tabpanel">
      
      <!-- <div id="chartDw" style="width: 100%; height:100%; background-color: bisque;"></div> -->
      <!-- 기간계 두번째 탭 내용 -->
      <!------------------------------------------------------------------------------------------------------------>
      <div class="d-flex flex-row mb-3">

        <div class="p-2" style="width: 300px; background-color: #DEEBF7;">
          <!-- LEFT AERA - TABLE COUNT ////////////////////-->
          <div class="ps-3 pe-3 pt-3 pb-3 " style="background-color: #DEEBF7; height: 400px; width: 240px; float: left; position: relative;">

            <div align="left" class="mt-1">
              <span style="font-weight: bold; font-size: 14px; color:blue;">></span>
              <span style="font-weight: bold; font-size: 14px">전체테이블수</span>
            </div>

            <div align="center" class="pt-2 pb-3">
              <span class="badge text-bg-light" style="font-weight: bold; padding: 15px 25px 15px 25px; font-size: 16px;">
                8,472
                <hr>
                <span style="color: red; font-size: 10px;" class="pe-1">일 ▲</span><span 
                      style="color: red; font-size: 10px; border-right: thin solid red;" class="pe-2">3</span>
                <span style="color: red; font-size: 10px;" class="pe-1">주 ▲</span><span 
                      style="color: red; font-size: 10px; border-right: thin solid red;" class="pe-2">3</span>
                <span style="color: red; font-size: 10px;" class="pe-1">월 ▲</span><span 
                      style="color: red; font-size: 10px;" class="pe-1">3</span>
              </span>
            </div>

          </div>        
          <!-- LEFT AERA - TABLE COUNT ////////////////////-->          
        </div>

        <div class="p-2" style="width: 80%; min-width: 100px; background-color: red;"> <!--#DEEBF7;-->
          <!-- DW 차트 영역 -->
          <div class="" id="chartDwAp" style="height: 100%; overflow: hidden;">
          </div>
        </div>

          <!--div class="p-2" style="display: none; width: 240px; background-color: gray;">Flex item 3</div-->
        <div id="tableChangeBoard" class="p-2 " style="width: 350px; background-color: white;"> <!--d-none-->

          <div align="center" class="border-bottom mb-2 align-middle" 
               style="height: 25px; padding-bottom: 2rem;">
            <!-- <button id="btnTommorrow" type="button" class="btn btn-outline-dark btn-sm">&lt;</button> -->
            <button id="btnDayMinus" type="button" 
             class="align-middle" 
             style="height: 25px; border-radius:0.2rem; vertical-align: middle; border: thin solid gray; background-color: white;">&lt;</button>
            <span id="dwBaseDate" style="font-weight: bold; font-size: 14px;" class="p-1 align-middle">2023-03-01</span>
            <!-- <button id="btnYesterday" type="button" class="btn btn-outline-dark btn-sm">&gt;</button> -->
            <button id="btnDayPlus" type="button" 
             class="align-middle" 
             style="height: 25px; border-radius:0.2rem; vertical-align: middle; border: thin solid gray; background-color: white;">&gt;</button>
          </div>
          <div id="tableChangeBoardTitleDiv" class="pt-2">
            <div id="dwBizNameDiv" class="mb-2" align="center">
              <span style="font-weight: bold; font-size: 14px;" class="m-2 align-middle">전사공통(IF)</span>
            </div>
          </div>
          <div id="tableChangeBoardDiv" class="p-1">
            <div id="byDay"   class="mb-2">
              <span style="font-weight: bold; font-size: 14px; border-left: thin solid black; border-right: thin solid black;" 
                    class="ps-2 pe-2 m-2 align-middle">금일</span>
              <span style="font-weight: bold; font-size: 14px;" class="m-2 align-middle">2023-03-01</span>
            </div>
            <div id="byWeek"  class="mb-2">
              <span style="font-weight: bold; font-size: 14px; border-left: thin solid black; border-right: thin solid black;" 
                    class="ps-2 pe-2 m-2 align-middle">금주</span>
              <span style="font-weight: bold; font-size: 14px;" class="m-2 align-middle">2023-03-01</span>
            </div>
            <div id="byMonth" class="mb-2">
              <span style="font-weight: bold; font-size: 14px; border-left: thin solid black; border-right: thin solid black;" 
                    class="ps-2 pe-2 m-2 align-middle">금월</span>
              <span style="font-weight: bold; font-size: 14px;" class="m-2 align-middle">2023-03-01</span>
            </div>
          </div>
        </div>
      </div>

      <!--
      TABLE 정보 시작
      -->       
      <div class="row" id="bottomDivRow2" >

        <div align="right" class="mb-2 mt-2">
          <span style="font-weight: bold; font-size: 20px; float: left">전사공통(IF)</span>
          <span style="color: red; font-size: 12px;">* 용량(MB)/건수는 데이터 기준일 기반으로 수정되어 표시됩니다.</span>
          <button id="btnSortByCreatedDate2" type="button" class="btn btn-secondary btn-sm">최근 생성일순 정렬</button>
          <button id="btnExpand2" type="button"   class="btn btn-secondary btn-sm">+펼치기</button>
          <button id="btnCollapse2" type="button" class="btn btn-secondary btn-sm d-none">-줄이기</button>
        </div>

        <div id="bottomData2" class="col-12" style="height: 300px; overflow-y:scroll;">

          <div id="tableList2Div">
            <table id="tableList2Grid"></table>
            <div id="tableList2GridPager"></div>
          </div>

        </div>

      </div>
      <!--
      TABLE 정보 끝
      -->

      <!------------------------------------------------------------------------------------------------------------>
      <!-- 기간계 두번째 탭 내용 -->
    </div>
  </div>
</div>


<!-- html contents END -->

    <!--script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" ></script-->
    <!--script src="ui/bootstrap-5.3.0/js/bootstrap.bundle.min.js" ></script-->
    <script src="ui/bootstrap-5.3.0/js/bootstrap.bundle.js" ></script>    

    <script src="ui/jquery/jquery-3.5.1.js" ></script>
    <script src="ui/apache-echart-5.4/echarts.min.js" ></script>

    <script src="ui/jquery-ui-1.12.1/jquery-ui.min.js" ></script>

    <script src="ui/jqGrid/jquery.jqgrid.min.js" ></script>
    <script src="ui/jqGrid/i18n/grid.locale-kr.js" ></script>    

<!-- 
    <script src="ui/jqGrid-4.7.0/js/jquery.jqGrid.min.js" ></script>
    <script src="ui/jqGrid-4.7.0/js/i18n/grid.locale-kr.js" ></script>
-->
    <script type="text/javascript">

    var formatUtil;
    var chartDomCoreAp = null;
    var myChartCoreAp = null;

    var chartDomDwAp = null;
    var myChartDwAp = null;

    function fn_set_event()
    {
      // 데이터 초기화
      //setChartDataLegacy();
      //setChartDataDw();

      //formatUtil = echarts.format;
      //alert("fn_set_event");
      fn_setGrid();
      drawChartCoreAp();
      //drawChartDwAp();

      $('.nav-item').click(function(){
        //console.log('nav-item.resize !' + myChartDwAp.getWidth());
        // if ( myChartDwAp.getWidth() == 0 ) myChartDwAp.resize();
        // if ( myChartCoreAp.getWidth() == 0 ) myChartCoreAp.resize();

        var navTabName = document.querySelector("a.nav-link.active").getAttribute('href');
        console.log('navTabName : ' + navTabName);
        if ( navTabName == '#tab1') {

        } else if (navTabName == '#tab2') {
          // 두번째 탭을 선택할때 초기화 수행
          //alert('nav-link setTimeout');
          if ( chartDomDwAp == null ) {
            setTimeout(function (){
              //setChartDataDw();
              drawChartDwAp();
            }, 500 );
          }
        }

      });

      // 기간계
      $('#btnExpand1').click(function(){
        //showTableUsageDivTop10();
        document.getElementById('btnExpand1').classList.add('d-none');
        document.getElementById('btnCollapse1').classList.remove('d-none');
        //myChartCoreAp.resize();
        document.getElementById('bottomData1').style.height = '300px';
        var rowIds = $("#tableList1Grid").jqGrid("getDataIDs");
        for (var i = 0; i < rowIds.length; i++) {
          var rowId = rowIds[i];
          var rowData = $("#tableList1Grid").jqGrid("getRowData", rowId);
          var rowHeight = 100;
          $("#tableList1Grid").jqGrid("setRowData", rowId, false, { height: rowHeight }); // 각 행의 높이 조정
        }

      });

      $('#btnCollapse1').click(function(){
        document.getElementById('btnCollapse1').classList.add('d-none');
        document.getElementById('btnExpand1').classList.remove('d-none');
        //myChartCoreAp.resize();
        document.getElementById('bottomData1').style.height = '300px';
        var rowIds = $("#tableList1Grid").jqGrid("getDataIDs");
        for (var i = 0; i < rowIds.length; i++) {
          var rowId = rowIds[i];
          var rowData = $("#tableList1Grid").jqGrid("getRowData", rowId);
          var rowHeight = 23;
          $("#tableList1Grid").jqGrid("setRowData", rowId, false, { height: rowHeight }); // 각 행의 높이 조정
        }
      });

      // 정보계
      $('#btnExpand2').click(function(){
        document.getElementById('btnExpand2').classList.add('d-none');
        document.getElementById('btnCollapse2').classList.remove('d-none');
        document.getElementById('bottomData2').style.height = '300px';
        var rowIds = $("#tableList2Grid").jqGrid("getDataIDs");
        for (var i = 0; i < rowIds.length; i++) {
          var rowId = rowIds[i];
          var rowData = $("#tableList2Grid").jqGrid("getRowData", rowId);
          var rowHeight = 100;
          $("#tableList2Grid").jqGrid("setRowData", rowId, false, { height: rowHeight }); // 각 행의 높이 조정
        }
      });

      $('#btnCollapse2').click(function(){
        document.getElementById('btnCollapse2').classList.add('d-none');
        document.getElementById('btnExpand2').classList.remove('d-none');
        document.getElementById('bottomData2').style.height = '300px';
        var rowIds = $("#tableList2Grid").jqGrid("getDataIDs");
        for (var i = 0; i < rowIds.length; i++) {
          var rowId = rowIds[i];
          var rowData = $("#tableList2Grid").jqGrid("getRowData", rowId);
          var rowHeight = 23;
          $("#tableList2Grid").jqGrid("setRowData", rowId, false, { height: rowHeight }); // 각 행의 높이 조정
        }
      });

      $('#btnDayPlus').click(function(){
        var todayStr = document.getElementById('dwBaseDate').innerHTML;
        document.getElementById('dwBaseDate').innerHTML = fn_getDayPlusStr(todayStr);
      });
      $('#btnDayMinus').click(function(){
        var todayStr = document.getElementById('dwBaseDate').innerHTML;
        document.getElementById('dwBaseDate').innerHTML = fn_getDayMinusStr(todayStr);
      });
      document.getElementById('dwBaseDate').innerHTML = fn_getTodayStr();

    }


    function fn_getDayPlusStr(str) {
      var date1  = new Date(str);
      var tomorrow = new Date(str);
      tomorrow.setDate(date1.getDate() + 1);

      var year1  = tomorrow.getFullYear();
      var month1 = tomorrow.getMonth() + 1;
      var day1   = tomorrow.getDate();      
      if ( month1 < 10 ) month1 = "0" + month1;
      if ( day1 < 10 ) day1 = "0" + day1;
      //console.log(year1 + "-" + month1 + "-" + day1);
      return year1 + "-" + month1 + "-" + day1;
    }

    function fn_getDayMinusStr(str) {
      var date1  = new Date(str);
      var yesterday = new Date(str);
      yesterday.setDate(date1.getDate() - 1);

      var year1  = yesterday.getFullYear();
      var month1 = yesterday.getMonth() + 1;
      var day1   = yesterday.getDate();      
      if ( month1 < 10 ) month1 = "0" + month1;
      if ( day1 < 10 ) day1 = "0" + day1;
      // console.log(year1 + "-" + month1 + "-" + day1);
      return year1 + "-" + month1 + "-" + day1;
    }

    function fn_getTodayStr() {
      var date1  = new Date();
      var year1  = date1.getFullYear();
      var month1 = date1.getMonth() + 1;
      if ( month1 < 10 ) month1 = "0" + month1;
      var day1   = date1.getDate();
      if ( day1 < 10 ) day1 = "0" + day1;
      //alert(year1 + "-" + month1 + "-" + day1);
      return year1 + "-" + month1 + "-" + day1;
    }

    /*
    * 그리드 정의
    */
    function fn_setGrid() {

      $("#tableUsageTop10Grid").jqGrid({
          datatype: "local",
          height: '100%',	//그리드 높이 설정(px, %, auto)
          colModel: [
              { name:'RN'             , index:'RN' ,hidden:true, width:50   ,align:'center'  ,label:'순번 '},         
              { name: "TABLE_NAME", index:"TABLE_NAME", label:'테이블명', width:100},
              { name: "COL_NAME"  , index:"COL_NAME",   label:'컬럼명',   width:100},
              { name: "HIT_COUNT" , index:"HIT_COUNT",  label:'활용건수', width:100, align:'right', 
                formatter: "integer"   , formatoptions: { thousandsSeparator: ","}}
          ],
          data: [
              { RN: 1, TABLE_NAME: "Angela", COL_NAME: "Merkel", HIT_COUNT: 1241},
              { RN: 2, TABLE_NAME: "Vladimir", COL_NAME: "Putin", HIT_COUNT: 1241 },
              { RN: 3, TABLE_NAME: "David", COL_NAME: "Cameron", HIT_COUNT: 1241 },
              { RN: 4, TABLE_NAME: "Barack", COL_NAME: "Obama", HIT_COUNT: 1241 },
              { RN: 5, TABLE_NAME: "François", COL_NAME: "Hollande", HIT_COUNT: 1241 },
              { RN: 6, TABLE_NAME: "Angela", COL_NAME: "Merkel", HIT_COUNT: 1241},
              { RN: 7, TABLE_NAME: "Vladimir", COL_NAME: "Putin", HIT_COUNT: 1241 },
              { RN: 8, TABLE_NAME: "David", COL_NAME: "Cameron", HIT_COUNT: 1241 },
              { RN: 9, TABLE_NAME: "Barack", COL_NAME: "Obama", HIT_COUNT: 1241 },
              { RN: 10, TABLE_NAME: "François", COL_NAME: "Hollande", HIT_COUNT: 1241 }
          ]
      });


      $('#tableList1Grid').jqGrid({
        //url: "${pageContext.request.contextPath}/common/dq/select/DQ_DQI/selectDqProfileCodeSearch-grid.do",
        //url: "${pageContext.request.contextPath}/common/dq/select/DQ_DQI/selectDqProfileCodeSearch-grid.do",
        mtype: 'POST',
        datatype: "local",	//그리드를 채우는 데이터 형식(json, jsonstring..)
        colModel: [			//그리드 Body에 보여질 데이터 속성
          //name:서버로부터 넘어오는 데이터명, index:정렬에 사용할 때 서버로 전송 시 넘어가는 데이터명
                {name:'RN'             , index:'RN' ,hidden:true, width:50   ,align:'center'  ,label:'순번 '}         
                ,{name:'TABLE_ENG_NM'      , index:'TABLE_ENG_NM'       ,width:200  ,align:'left'   ,label:'테이블명'}    
                ,{name:'TABLE_NM'      , index:'TABLE_NM'       ,width:200  ,align:'left'   ,label:'테이블한글명'}    

                ,{name:'TABLE_DESC'      , index:'TABLE_DESC'       ,width:200  ,align:'left'   ,label:'테이블설명'}    

                ,{name:'DEPT_NM'         , index:'DEPT_NM'          ,width:150  ,align:'center'   ,label:'현업부서' }
                ,{name:'STORAGE_MB'      , index:'STORAGE_MB'       ,width:90  ,align:'right'  ,label:'용량(MB)', formatter: "integer"   , formatoptions: { thousandsSeparator: ","}}
                ,{name:'ROW_CNT'         , index:'ROW_CNT'          ,width:90  ,align:'right' ,label:'건수', formatter: "integer"   , formatoptions: { thousandsSeparator: ","}}
                ,{name:'BASE_DATE'         , index:'BASE_DATE'          ,width:110  ,align:'center'  ,label:'데이터기준일'}
        ],

        data: [
                { RN:1, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "Angela", TABLE_DESC: "Merkel", DEPT_NM: "부서1", STORAGE_MB:2, ROW_CNT:3, BASE_DATE:'2023-03-27' },
                { RN:2, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "Vladimir", TABLE_DESC: "Putin", DEPT_NM: "부서1", STORAGE_MB:2, ROW_CNT:3, BASE_DATE:'2023-03-27' },
                { RN:3, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "David", TABLE_DESC: "Cameron", DEPT_NM: "부서1", STORAGE_MB:2, ROW_CNT:3, BASE_DATE:'2023-03-27' },
                { RN:4, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "Barack", TABLE_DESC: "Obama", DEPT_NM: "부서1", STORAGE_MB:2, ROW_CNT:3, BASE_DATE:'2023-03-27' },
                { RN:5, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "François", TABLE_DESC: "Hollande", DEPT_NM: "부서1", STORAGE_MB:2, ROW_CNT:3, BASE_DATE:'2023-03-27' }
            ],

        height: '250px',	//그리드 높이 설정(px, %, auto)
        autowidth: true,	//그리드 상위 Element의 width로 자동 계산
        shrinkToFit: true,	//우측 스크롤바 위의 공간을 없애고 width 채움(default:true)
        //shrinkToFit: false,	//우측 스크롤바 위의 공간을 없애고 width 채움(default:true)
        resizeStop: function() {
        },
        loadComplete: function() {
          fn_setBottomGridWidth();
        },
        //rowHeight: auto,
        rowNum: 200,	//한페이지에 보여질 데이터 수
        rownumbers: false,	//줄번호를 자동으로 표시할지 여부
        rowList: [10, 50, 100],	//표시되는 행의 수
        multiselect: false, //체크박스 여부
        pager: '#tableList1GridPager',	//페이징 엘리먼트 지정
        viewrecords: true,
        caption: "",	//그리드 상단 제목 정의
        emptyrecords: "검색된 데이터가 없습니다.",	//데이터가 없는 경우 페이저 오른쪽에 표시할 문구(조건:viewrecords:true)
        //ignoreCase: true,	//검색 및 정렬에서 대소문자 구분 여부
        loadtext: "데이터를 검색 중입니다..",	//데이터 로딩 중 표시할 문구
        sortable: true,	//그리드 열을 마우스로 드래그앤드롭으로 이동 가능
        viewsortcols: [true, 'vertical', true]
      });

      $('#tableList2Grid').jqGrid({
        //url: "${pageContext.request.contextPath}/common/dq/select/DQ_DQI/selectDqProfileCodeSearch-grid.do",
        //url: "${pageContext.request.contextPath}/common/dq/select/DQ_DQI/selectDqProfileCodeSearch-grid.do",
        mtype: 'POST',
        datatype: "local",	//그리드를 채우는 데이터 형식(json, jsonstring..)
        colModel: [			//그리드 Body에 보여질 데이터 속성
          //name:서버로부터 넘어오는 데이터명, index:정렬에 사용할 때 서버로 전송 시 넘어가는 데이터명
                {name:'RN'             , index:'RN' ,hidden:true, width:50   ,align:'center'  ,label:'순번 '}         
                ,{name:'TABLE_ENG_NM'      , index:'TABLE_ENG_NM'       ,width:200  ,align:'left'   ,label:'테이블명'}    
                ,{name:'TABLE_NM'      , index:'TABLE_NM'       ,width:200  ,align:'left'   ,label:'테이블한글명'}    

                ,{name:'TABLE_DESC'      , index:'TABLE_DESC'       ,width:200  ,align:'left'   ,label:'테이블설명'}    

                ,{name:'DEPT_NM'         , index:'DEPT_NM'          ,width:150  ,align:'center'   ,label:'현업부서' }
                //,{name:'STORAGE_MB'      , index:'STORAGE_MB'       ,width:90  ,align:'right'  ,label:'용량(MB)', formatter: "integer"   , formatoptions: { thousandsSeparator: ","}}
                //,{name:'ROW_CNT'         , index:'ROW_CNT'          ,width:90  ,align:'right' ,label:'건수', formatter: "integer"   , formatoptions: { thousandsSeparator: ","}}
                ,{name:'BASE_DATE'       , index:'BASE_DATE'        ,width:110  ,align:'center'  ,label:'데이터기준일', }
        ],

        data: [
                { RN:1, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "Angela", TABLE_DESC: "Merkel", DEPT_NM: "부서1", BASE_DATE:'2023-03-27' },
                { RN:2, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "Vladimir", TABLE_DESC: "Putin", DEPT_NM: "부서1", BASE_DATE:'2023-03-27' },
                { RN:3, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "David", TABLE_DESC: "Cameron", DEPT_NM: "부서1",  BASE_DATE:'2023-03-27' },
                { RN:4, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "Barack", TABLE_DESC: "Obama", DEPT_NM: "부서1",  BASE_DATE:'2023-03-27' },
                { RN:5, TABLE_ENG_NM: 'TABLE1', TABLE_NM: "François", TABLE_DESC: "Hollande", DEPT_NM: "부서1", BASE_DATE:'2023-03-27' }
        ],

        height: '250px',	//그리드 높이 설정(px, %, auto)
        autowidth: true,	//그리드 상위 Element의 width로 자동 계산
        shrinkToFit: true,	//우측 스크롤바 위의 공간을 없애고 width 채움(default:true)
        //shrinkToFit: true,
        // 그리드가 리사이즈될 때 호출할 함수
        resizeStop: function() {
        },
        loadComplete: function() {
          fn_setBottomGridWidth();
        },
        rowNum: 10,	//한페이지에 보여질 데이터 수
        rownumbers: false,	//줄번호를 자동으로 표시할지 여부
        rowList: [10, 50, 100],	//표시되는 행의 수
        multiselect: false, //체크박스 여부
        pager: '#tableList2GridPager',	//페이징 엘리먼트 지정
        viewrecords: true,
        caption: "",	//그리드 상단 제목 정의
        emptyrecords: "검색된 데이터가 없습니다.",	//데이터가 없는 경우 페이저 오른쪽에 표시할 문구(조건:viewrecords:true)
        //ignoreCase: true,	//검색 및 정렬에서 대소문자 구분 여부
        loadtext: "데이터를 검색 중입니다..",	//데이터 로딩 중 표시할 문구
        sortable: true,	//그리드 열을 마우스로 드래그앤드롭으로 이동 가능
        viewsortcols: [true, 'vertical', true]
      });


      ////화면 크기 조절
      window.addEventListener('resize', function(){
        fn_setBottomGridWidth();
      });      

      function fn_setBottomGridWidth(){
        var navTabName = document.querySelector("a.nav-link.active").getAttribute('href');
        console.log('navTabName : ' + navTabName);
        if ( navTabName == '#tab1') {
          $('#tableList1Grid').setGridWidth($('#bottomDivRow1').width()-35, true);
          $('#tableList2Grid').setGridWidth($('#bottomDivRow1').width()-35, true);
          if ( myChartCoreAp != null ) myChartCoreAp.resize();
        } else if (navTabName == '#tab2') {
          $('#tableList1Grid').setGridWidth($('#bottomDivRow2').width()-35, true);          
          $('#tableList2Grid').setGridWidth($('#bottomDivRow2').width()-35, true);
          if ( myChartDwAp != null ) myChartDwAp.resize();
        }
      }
      
    }

    function drawTreemapChartCoreAp(pChartData, pChartName)
    {
      chartDomCoreAp = document.getElementById(pChartName);
      myChartCoreAp = echarts.init(chartDomCoreAp);
      myChartCoreAp.showLoading();
      myChartCoreAp.hideLoading();
      
      var option;
      option = {
              title: {
                //text: 'ECharts Options',
                //subtext: '2016/04',
                //left: 'leafDepth'
              },
              tooltip: {
                trigger: 'item',
                //triggerOn: 'mousemove'

                  formatter: function (info) {
                      var value = info.value;
                      var treePathInfo = info.treePathInfo;
                      var treePath = [];
                      var tablePctVal = 0;
                      var tableTotCntVal = 0;
                      var subjName = '';
                      //alert(JSON.stringify(info));
                      //console.log(JSON.stringify(info));
                      tableTotCntVal = treePathInfo[0].value;

                      for (var i = 1; i < treePathInfo.length; i++) {
                          treePath.push(treePathInfo[i].name);
                      }

                      if (treePathInfo.length == 2) {
                        tablePctVal = info.value / tableTotCntVal;
                        //반올림
                        tablePctVal = Math.round(tablePctVal*1000)/10;
                        return [
                          //'<div class="tooltip-title">' + formatUtil.encodeHTML(treePath.join('/')) + '</div>',
                          '<div class="tooltip-title">' + info.name + '</div>',
                          tablePctVal + ' %',
                          '<BR>(' + value + ')'+'<span style="color: red">▲ ' + 2 + '</span>',
                        ].join('');
                      }

                      if (treePathInfo.length == 3) {
                        tableTotCntVal = treePathInfo[1].value;
                        tablePctVal = info.value / tableTotCntVal;
                        //반올림
                        tablePctVal = Math.round(tablePctVal*1000)/10;
                        return [
                          //'<div class="tooltip-title">' + formatUtil.encodeHTML(treePath.join('/')) + '</div>',
                          '<div class="tooltip-title">' + info.name + '</div>',
                          tablePctVal + ' %',
                          '<BR>(' + value + ')'+'<span style="color: red">▲ ' + 2 + '</span>',
                        ].join('');
                      } else {
                        return [
                          '<div class="tooltip-title">' + info.name + '</div>',
                          '' + value + '',
                        ].join('');
                      }

                      if ( treePathInfo.length == 3 ) {
                        console.log('1:'+ JSON.stringify(treePathInfo[1]));
                        console.log('2:'+ JSON.stringify(treePathInfo[2]));
                        tablePctVal = treePathInfo[2].value / treePathInfo[1].value * 100;
//                        tablePctVal = Math.ceil(tablePctVal / 10) * 10;
                        subjName = treePathInfo[2].value + '/' + treePathInfo[1].value;
                      }                      

                  }

              },
              series: [
                          {
                            name: '기간계',
                            type: 'treemap',
                            data: pChartData.children,
                            visibleMin: 300,
                            //width: '95%', height: '95%',
                            width: '100%', height: '100%',
                            //data: data.children,
                            leafDepth: 1,
                            label: {
                              show: true,
                              formatter: function (params) {

                                if (params.treePathInfo.length == 2) {
                                  //return '{${params.name}}'
                                }
                                var totSize=  params.treePathInfo[0].value;
                                var size=(params.value/totSize)*100;
                                if (size>8) {
                                  return '{lg|'+params.name+'}'
                                    + '\n{md|' + params.value + '}'
                                    + '\n{mdRed|▲' + params.data.inc_val1 + '}';
                                }
                                if (size>2) {
                                  return '{md|'+params.name+'}'
                                    + '\n{md|' + params.value + '}'
                                    + '\n{mdRed|▲' + params.data.inc_val1 + '}';
                                }
                                return '{sm|'+params.name+'}'
                                    + '\n{sm|' + params.value + '}'
                                    + '\n{smRed|▲' + params.data.inc_val1 + '}';

                              },
                              rich: {
                                lg: { fontSize: 20, },
                                lgRed: { fontSize: 20, color: '#f00'},                                
                                md: { fontSize: 15, },
                                mdRed: { fontSize: 15, color: '#f00'},
                                sm: { fontSize: 10, },
                                smRed: { fontSize: 10, color: '#f00'},
                              }
                            },
                            levels: [
                                      {
                                        itemStyle: {
                                          borderColor: '#DDDDDD', 
                                          //borderColor: '#555', 
                                          borderWidth: 4,
                                          gapWidth: 4
                                        }
                                      },
                                      {
                                        colorSaturation: [0.3, 0.6],
                                        itemStyle: {
                                          borderColorSaturation: 0.7,
                                          gapWidth: 2,
                                          borderWidth: 2
                                        }
                                      },
                                      {
                                        colorSaturation: [0.3, 0.5],
                                        itemStyle: {
                                          borderColorSaturation: 0.6,
                                          gapWidth: 1
                                        }
                                      },
                                      {
                                        colorSaturation: [0.3, 0.5]
                                      }
                                    ]
                          }
                      ]
               };
      
      myChartCoreAp.setOption(option); // 차트 디스플레이
      //window.addEventListener('resize', myChartCoreAp.resize);
      myChartCoreAp.on('click', function(params) {
        // Print name in console
        console.log("---------- myChartCoreAp.click ----------");
        console.log(params.name);
        console.log(params.dataIndex);
        console.log(params.data);
        console.log(JSON.stringify(params.data));

        console.log( "params.treePathInfo.length : " + params.treePathInfo.length );

        if ( params.treePathInfo.length == 3 ) {
          showTableUsageDivTop10();
        } 
        else if ( params.treePathInfo.length == 1 || params.treePathInfo.length == 2)
        {
          hideTableUsageDivTop10();
        }
        return;

      });
    }

    function drawTreemapChartDwAp(pChartData, pChartName)
    {
      //alert('drawTreemapChartDw');
      chartDomDwAp = document.getElementById(pChartName);
      myChartDwAp = echarts.init(chartDomDwAp);
      myChartDwAp.showLoading();
      myChartDwAp.hideLoading();
      
      var optionDw;
      optionDw = {
              title: {
                //text: 'ECharts Options',
                //subtext: '2016/04',
                //left: 'leafDepth'
              },
              tooltip: {
                trigger: 'item',
                //triggerOn: 'mousemove'

                  formatter: function (info) {
                      var value = info.value;
                      var treePathInfo = info.treePathInfo;
                      var treePath = [];
                      var tablePctVal = 0;
                      var tableTotCntVal = 0;
                      var subjName = '';
                      //alert(JSON.stringify(info));
                      //console.log(JSON.stringify(info));
                      tableTotCntVal = treePathInfo[0].value;

                      for (var i = 1; i < treePathInfo.length; i++) {
                          treePath.push(treePathInfo[i].name);
                      }

                      if (treePathInfo.length == 2) {
                        tablePctVal = info.value / tableTotCntVal;
                        //반올림
                        tablePctVal = Math.round(tablePctVal*1000)/10;
                        return [
                          //'<div class="tooltip-title">' + formatUtil.encodeHTML(treePath.join('/')) + '</div>',
                          '<div class="tooltip-title">' + info.name + '</div>',
                          tablePctVal + ' %',
                          '<BR>(' + value + ')'+'<span style="color: red">▲ ' + 2 + '</span>',
                        ].join('');
                      }

                      if (treePathInfo.length == 3) {
                        tableTotCntVal = treePathInfo[1].value;
                        tablePctVal = info.value / tableTotCntVal;
                        //반올림
                        tablePctVal = Math.round(tablePctVal*1000)/10;
                        return [
                          //'<div class="tooltip-title">' + formatUtil.encodeHTML(treePath.join('/')) + '</div>',
                          '<div class="tooltip-title">' + info.name + '</div>',
                          tablePctVal + ' %',
                          '<BR>(' + value + ')'+'<span style="color: red">▲ ' + 2 + '</span>',
                        ].join('');
                      } else {
                        return [
                          '<div class="tooltip-title">' + info.name + '</div>',
                          '' + value + '',
                        ].join('');
                      }

                      if ( treePathInfo.length == 3 ) {
                        console.log('1:'+ JSON.stringify(treePathInfo[1]));
                        console.log('2:'+ JSON.stringify(treePathInfo[2]));
                        tablePctVal = treePathInfo[2].value / treePathInfo[1].value * 100;
//                        tablePctVal = Math.ceil(tablePctVal / 10) * 10;
                        subjName = treePathInfo[2].value + '/' + treePathInfo[1].value;
                      }                      

                  }

              },
              series: [
                          {
                            name: '정보계',
                            type: 'treemap',
                            data: pChartData.children,
                            visibleMin: 300,
                            //width: '95%', height: '95%',
                            width: '100%', height: '100%',
                            //data: data.children,
                            leafDepth: 1,
                            label: {
                              show: true,
                              formatter: function (params) {

                                console.log('-----------------------------------------------');
                                console.log('formatter 902 : ' + JSON.stringify(params) )  ;
                                console.log('-----------------------------------------------');

                                if (params.treePathInfo.length == 2) {
                                  //return '{${params.name}}'
                                }
                                var totSize=  params.treePathInfo[0].value;
                                var size=(params.value/totSize)*100;
                                if (size>8) {
                                  return '{lg|'+params.name+'}'
                                    + '\n{md|' + params.value + '}'
                                    + '\n{mdRed|▲' + params.data.inc_val1 + '}';
                                }
                                if (size>2) {
                                  return '{md|'+params.name+'}'
                                    + '\n{md|' + params.value + '}'
                                    + '\n{mdRed|▲' + params.data.inc_val1 + '}';
                                }
                                return '{sm|'+params.name+'}'
                                    + '\n{sm|' + params.value + '}'
                                    + '\n{smRed|▲' + params.data.inc_val1 + '}';

                              },
                              rich: {
                                lg: { fontSize: 20, },
                                lgRed: { fontSize: 20, color: '#f00'},                                
                                md: { fontSize: 15, },
                                mdRed: { fontSize: 15, color: '#f00'},
                                sm: { fontSize: 10, },
                                smRed: { fontSize: 10, color: '#f00'},
                              }
                            },
                            levels: [
                                      {
                                        itemStyle: {
                                          borderColor: '#DDDDDD', 
                                          //borderColor: '#555', 
                                          borderWidth: 4,
                                          gapWidth: 4
                                        }
                                      },
                                      {
                                        colorSaturation: [0.3, 0.6],
                                        itemStyle: {
                                          borderColorSaturation: 0.7,
                                          gapWidth: 2,
                                          borderWidth: 2
                                        }
                                      },
                                      {
                                        colorSaturation: [0.3, 0.5],
                                        itemStyle: {
                                          borderColorSaturation: 0.6,
                                          gapWidth: 1
                                        }
                                      },
                                      {
                                        colorSaturation: [0.3, 0.5]
                                      }
                                    ]
                          }
                      ]
               };
      
      myChartDwAp.setOption(optionDw); // 차트 디스플레이
      //window.addEventListener('resize', myChartDwAp.resize);
    }

    function getChartRawDataCoreAp(){
      return getChartRawDataDwAp();
    }

    function getChartRawDataDwAp(){
      var jsonData1 = [];
      jsonData1.push({"id":"CT",   "par_id":"NULL", "biz_id":"CT", "name":"계약(CT)", "value":0, "inc_val1":"3", "inc_val2":"0"});
      jsonData1.push({"id":"CT01", "par_id":"CT", "biz_id":"CT01", "name":"계약관리", "value":357, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT02", "par_id":"CT", "biz_id":"CT02", "name":"청약", "value":304, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT03", "par_id":"CT", "biz_id":"CT03", "name":"UW",   "value":288, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT04", "par_id":"CT", "biz_id":"CT04", "name":"계약", "value":307, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT05", "par_id":"CT", "biz_id":"CT05", "name":"입출금", "value":178, "inc_val1":"0", "inc_val2":"1"});
      jsonData1.push({"id":"CT06", "par_id":"CT", "biz_id":"CT06", "name":"안내증빙", "value":45, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT07", "par_id":"CT", "biz_id":"CT07", "name":"출수재", "value":137, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT08", "par_id":"CT", "biz_id":"CT08", "name":"대외연계", "value":293, "inc_val1":"0", "inc_val2":"1"});
      jsonData1.push({"id":"CT09", "par_id":"CT", "biz_id":"CT09", "name":"계약권한", "value":27, "inc_val1":"0", "inc_val2":"1"});
      jsonData1.push({"id":"CT10", "par_id":"CT", "biz_id":"CT10", "name":"보험수리", "value":144, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT11", "par_id":"CT", "biz_id":"CT11", "name":"통계지표", "value":139, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CT12", "par_id":"CT", "biz_id":"CT12", "name":"방카슈랑스", "value":56, "inc_val1":"0", "inc_val2":"2"});
      jsonData1.push({"id":"CT13", "par_id":"CT", "biz_id":"CT13", "name":"TM", "value":46, "inc_val1":"0", "inc_val2":"1"});

      jsonData1.push({"id":"CS",   "par_id":"NULL", "biz_id":"CS", "name":"법인영업(CS)", "value":0, "inc_val1":"2", "inc_val2":"0"});
      jsonData1.push({"id":"CS01", "par_id":"CS"  , "biz_id":"CS01", "name":"법인기업정보", "value":357, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CS02", "par_id":"CS"  , "biz_id":"CS02", "name":"법인영업활동", "value":304, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CS03", "par_id":"CS"  , "biz_id":"CS03", "name":"법인매출실적",   "value":288, "inc_val1":"0", "inc_val2":"0"});
      jsonData1.push({"id":"CS04", "par_id":"CS"  , "biz_id":"CS04", "name":"방카제휴", "value":63, "inc_val1":"0", "inc_val2":"0"});

      jsonData1.push({"id":"CP",   "par_id":"NULL", "biz_id":"CP", "name":"준법감시(CP)", "value":0, "inc_val1":"4", "inc_val2":"0"});
      jsonData1.push({"id":"CP01", "par_id":"CP"  , "biz_id":"CP01", "name":"내부통제", "value":50, "inc_val1":"30", "inc_val2":"40"});
      jsonData1.push({"id":"CP02", "par_id":"CP"  , "biz_id":"CP02", "name":"자금세탁", "value":47, "inc_val1":"10", "inc_val2":"20"});
      jsonData1.push({"id":"CP03", "par_id":"CP"  , "biz_id":"CP03", "name":"세무서관리",   "value":8, "inc_val1":"1", "inc_val2":"10"});
      jsonData1.push({"id":"CP04", "par_id":"CP"  , "biz_id":"CP04", "name":"법률지식시스템", "value":6, "inc_val1":"0", "inc_val2":"6"});
      jsonData1.push({"id":"CP05", "par_id":"CP"  , "biz_id":"CP05", "name":"상시모니터링",   "value":61, "inc_val1":"10", "inc_val2":"7"});
      jsonData1.push({"id":"CP06", "par_id":"CP"  , "biz_id":"CP06", "name":"정보보호", "value":42, "inc_val1":"1", "inc_val2":"9"});

      jsonData1.push({"id":"PS",   "par_id":"NULL", "biz_id":"PS", "name":"개인영업(PS)", "value":0, "inc_val1":"5", "inc_val2":"0"});
      jsonData1.push({"id":"PS01", "par_id":"PS"  , "biz_id":"PS01", "name":"증원관리", "value":91, "inc_val1":"30", "inc_val2":"40"});
      jsonData1.push({"id":"PS02", "par_id":"PS"  , "biz_id":"PS02", "name":"영업조직", "value":92, "inc_val1":"10", "inc_val2":"20"});
      jsonData1.push({"id":"PS03", "par_id":"PS"  , "biz_id":"PS03", "name":"영업활동",   "value":355, "inc_val1":"1", "inc_val2":"10"});
      jsonData1.push({"id":"PS04", "par_id":"PS"  , "biz_id":"PS04", "name":"영업매출", "value":215, "inc_val1":"0", "inc_val2":"6"});
      jsonData1.push({"id":"PS05", "par_id":"PS"  , "biz_id":"PS05", "name":"영업이관", "value":11, "inc_val1":"0", "inc_val2":"6"});
      jsonData1.push({"id":"PS06", "par_id":"PS"  , "biz_id":"PS06", "name":"영업소득", "value":344, "inc_val1":"0", "inc_val2":"6"});
      jsonData1.push({"id":"PS07", "par_id":"PS"  , "biz_id":"PS07", "name":"TC업무", "value":103, "inc_val1":"0", "inc_val2":"6"});
      jsonData1.push({"id":"PS08", "par_id":"PS"  , "biz_id":"PS08", "name":"GS", "value":65, "inc_val1":"0", "inc_val2":"6"});

      return jsonData1;
    }

    function getChartDataCoreApJson(){
      var jsonData = {children: []};
      var jsonArray1 = getChartRawDataCoreAp();

      makeChartDataJson(jsonData, jsonArray1, 'NULL');

      console.log('===========================================');
      console.log(jsonData);
      console.log('===========================================');
      return jsonData;
    }

    function getChartDataDwApJson(){
      var jsonData = {children: []};
      var jsonArray1 = getChartRawDataDwAp();

      makeChartDataJson(jsonData, jsonArray1, 'NULL');

      console.log('===========================================');
      console.log(jsonData);
      console.log('===========================================');
      return jsonData;
    }

    function makeChartDataJson(target, source, parentName) {

      console.log('makeChartDataJson : ' + parentName);

      for ( idx in source ) {
        console.log('makeChartDataJson : ' + parentName);
        if ( source[idx].par_id == parentName ) {
          if ( target.children == undefined ) {
            console.log("target.children is undefined ! ");
            target.children = [];
          }
          console.log("target.children : " + target.children );
          var source1 = source[idx];
          //if (parentName == 'NULL' && source1.value == 0 ) delete source1.value;
          if (source1.value == 0 ) delete source1.value;
          if (parentName != 'NULL') source1.name = target.name + '.' + source[idx].name;
          target.children.push(source[idx]);
          //console.log("pushed row : " + JSON.stringify(source[idx]) );
        }
      }
      //console.log(target.children.length);

      if (target.children != undefined && target.children.length > 0  ){
        console.log(target.children.length);
        for ( idx2 in target.children ) {
          makeChartDataJson(target.children[idx2], source, target.children[idx2].id);
        }
      }

    }

    /*
    function drawChartCoreAp(){
		  initChartCoreAp();
		  var chartData1 = getChartDataLegacy();
		  var chartData = { children: [] };      
      convertData(chartData1, chartData, '');
      console.log("-------------------- drawChartCoreAp chartData --------------------");
      console.log(JSON.stringify(chartData));      
      console.log("-------------------- drawChartCoreAp chartData --------------------");      
      drawTreemapChartCoreAp(chartData, 'chartLegacy');
    }*/

    function drawChartCoreAp(){
		  initChartCoreAp();
		  var chartData = { children: [] };      
      chartData = getChartDataCoreApJson();
      console.log("-------------------- drawChartCoreAp chartData --------------------");
      console.log(JSON.stringify(chartData));      
      console.log("-------------------- drawChartCoreAp chartData --------------------");      
      drawTreemapChartCoreAp(chartData, 'chartCoreAp');
    }

    function drawChartDwAp(){
		  initChartDwAp();
		  //var chartData1 = getChartDataDw();
		  var chartData = { children: [] };
      //convertData(chartData1, chartData, '');
      chartData = getChartDataDwApJson();
      console.log("-------------------- drawChartDwAp chartData --------------------");
      console.log(JSON.stringify(chartData));      
      console.log("-------------------- drawChartDwAp chartData --------------------");           
		  drawTreemapChartDwAp(chartData, 'chartDwAp');
    }

  /*
    function convertData(source, target, basePath) {
      for (let key in source) {
        let path = basePath ? basePath + '.' + key : key;
        if (!key.match(/^\$/)) {
          target.children = target.children || [];
          const child = {
            name: path
          };
          target.children.push(child);
          convertData(source[key], child, path);
        }
      }
      if (!target.children) {
        target.value = source.$count || 1;
        target.bizname = source.$bizname || 1;      
      } else {
        target.children.push({
          name: basePath,
          value: source.$count,
          bizname: 'null'
        });
      }
    }
  */

    function initChartCoreAp(){
      chartDomCoreAp = document.getElementById('chartCoreAp');
      myChartCoreAp = echarts.init(chartDomCoreAp);
      myChartCoreAp.clear();
    }
    
    function initChartDwAp(){
      chartDomDwAp = document.getElementById('chartDwAp');
      myChartDwAp = echarts.init(chartDomDwAp);
      myChartDwAp.clear();
    }

    $(document).ready(function() {
        //이벤트 설정
        fn_set_event();
        //fn_drawChartBizArchi();
        //drawChartSample();

        //setChartDataDwJson();
    });

    function hideTableUsageDivTop10(){
      //$("#tableUsageTop10").css("display","none");  // 속성값 : none, block
      document.getElementById('tableUsageTop10').classList.add('d-none');
      setTimeout(function (){
        myChartCoreAp.resize();      
      }, 50);

    }
    function showTableUsageDivTop10(){
      //$("#tableUsageTop10").css("display","block");  // 속성값 : none, block
      document.getElementById('tableUsageTop10').classList.remove('d-none');
      //myChartCoreAp.resize();            
      setTimeout(function (){
        //myChartCoreAp.resize();      
      }, 1000);
    }

    </script>
</body>    

</head>
</body>
</html>
